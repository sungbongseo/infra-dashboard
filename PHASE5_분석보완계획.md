# Phase 5 대시보드 분석 보완 계획

> 3개 에이전트 병렬 심층 분석 결과 종합 (페이지별 기능/데이터레이어/UI컴포넌트)

---

## 1. 심각도별 이슈 요약

### 🔴 CRITICAL (즉시 수정 필요)

| # | 위치 | 이슈 | 상세 |
|---|------|------|------|
| C1 | `profitability/page.tsx:309` | Waterfall 차트 미구현 | 일반 Bar 차트로 표시 중. 누적 높이, 연결선, 하향 음수 표시 없음 |
| C2 | `profitability/page.tsx:224` | 레이더 차트 Math.abs() | 손실(음수)이 이익(양수)과 동일하게 표시됨 |
| C3 | `orders/page.tsx:27-42` | 날짜 파싱 취약성 | Excel 시리얼 번호 처리 불완전, 에러 핸들링 없음 |
| C4 | `profiles/page.tsx:110` | share 비율 계산 오류 | share가 소수(0.25)인지 백분율(25)인지 검증 없음. 잘못되면 2500% 표시 |
| C5 | `parser.ts:79` | SalesRecord row[15] 스킵 | 15번째 컬럼이 누락됨. 헤더 오정렬 가능성 |
| C6 | `receivables/page.tsx:307` | ReferenceLine 위치 오류 | domain이 동적인데 100% 참조선이 고정값, 실제 위치와 불일치 |

### 🟠 HIGH (SAP 수준 미달)

| # | 위치 | 이슈 | 상세 |
|---|------|------|------|
| H1 | 전체 | filterStore 미연동 | 정의만 존재. 날짜/조직/담당자 필터 UI 및 기능 없음 |
| H2 | `dataStore.ts:67` | 조직 하드코딩 | DEFAULT_INFRA_ORG_NAMES가 코드에 고정. 새 조직 추가 시 배포 필요 |
| H3 | 전체 | 페이지 간 필터링 불일치 | 영업조직 vs 영업조직팀 필드 혼용으로 페이지별 다른 데이터셋 표시 가능 |
| H4 | `aging.ts:61-62` | 리스크 임계값 하드코딩 | 1억/5천만 기준이 코드에 고정. 조직 규모별 조정 불가 |
| H5 | `kpi.ts:188-213` | 비용구조 Math.abs() | 환불/역분개가 양수 비용으로 처리됨. 비용 과대 산정 |
| H6 | 전체 | 2개 파일 타입 미활용 | ProfitabilityAnalysisRecord, CustomerLedgerRecord 파싱만 하고 미사용 |
| H7 | 전체 | 내보내기(Export) 기능 없음 | CSV/Excel/PDF 내보내기 전무 |
| H8 | `sales/page.tsx` | KPI 카드 없음 | 매출 분석 페이지에 요약 KPI 미제공, 바로 차트로 진입 |

### 🟡 MEDIUM (기능 누락)

| # | 이슈 | 상세 |
|---|------|------|
| M1 | YoY/MoM 기간 비교 없음 | 전년 동기/전월 대비 분석 기능 전무 |
| M2 | 드릴다운 없음 | KPI 클릭 → 상세, 차트 클릭 → 필터 연동 없음 |
| M3 | DSO/현금전환주기 미산출 | 미수금 핵심 지표 누락 |
| M4 | 수주→매출→수금 퍼널 없음 | Order-to-Cash 파이프라인 시각화 미구현 |
| M5 | 예측 정확도 분석 없음 | 계획 vs 실적의 Bias 측정, 추세 예측 없음 |
| M6 | 가격/수량/믹스 분산분석 없음 | Three-way variance 미구현 |
| M7 | 테이블 정렬/검색 없음 | 모든 테이블이 정적, 컬럼 정렬/필터 불가 |
| M8 | 로딩 스켈레톤 없음 | 대용량 데이터 로드 시 빈 화면 |
| M9 | 에러 바운더리 없음 | 차트 렌더링 실패 시 전체 페이지 크래시 |

### 🔵 LOW (UX 개선)

| # | 이슈 | 상세 |
|---|------|------|
| L1 | 이름 잘림 without 툴팁 | width 고정으로 긴 이름 절단, hover 시에만 전체명 표시 |
| L2 | 하드코딩된 데이터 제한 | top 10/15/20 고정, 전체 보기 없음 |
| L3 | 비활성 탭 설명 없음 | disabled 탭 클릭 시 이유 안내 없음 |
| L4 | 모바일 반응형 미흡 | 7컬럼 그리드, 10컬럼 테이블 등 작은 화면에서 깨짐 |
| L5 | 차트 색상 미수금 연령별 비논리적 | 월별 안전→위험 그라데이션 아닌 랜덤 색상 |

---

## 2. 탭별 상세 분석

### 2.1 Overview (영업 실적 Overview)

**현재 상태**: 탭 2개 (핵심 지표 / 조직 분석), KPI 5개, 차트 3개

**이슈 목록**:
| 구분 | 내용 |
|------|------|
| 계산오류 | 수금율이 100% 초과 가능 — 캡핑/설명 없음 |
| 계산오류 | 미수금 = 매출 - 수금 단순 차감, 기초잔액 미반영 |
| 누락KPI | 전기 대비 증감율, 목표 달성 진척도, 수주잔고 |
| 누락기능 | 기간별 비교(YoY), 트렌드 요약 텍스트, 이상치 경보 |
| 누락차트 | 매출 계획 달성 게이지, 조직별 수금율 비교 |
| 시각화 | ComposedChart에서 수금 Line이 매출/수주 Bar와 스케일 불일치 시 왜곡 |

**보강 계획**:
- [ ] KPI 카드에 전기 대비 `previousValue` 연동
- [ ] 수금율 100% 초과 시 설명 툴팁 추가
- [ ] 조직별 수금율/계획달성율 종합 랭킹 차트 추가
- [ ] 경영진용 핵심 요약 텍스트 자동 생성
- [ ] 수주잔고 KPI (수주 - 매출) 추가

---

### 2.2 Sales (매출 분석)

**현재 상태**: 탭 3개 (거래처/품목/유형), KPI 없음, 차트 3개

**이슈 목록**:
| 구분 | 내용 |
|------|------|
| 구조결함 | KPI 카드 전무 — 총 매출, 거래처 수, 평균 거래액, 집중도 등 미표시 |
| 계산오류 | 내수/수출 분류 로직에서 수주유형 필드 의존 — 매출 레코드에 수주유형 없으면 전부 "내수" |
| 누락기능 | 월별 매출 추이 차트 없음 (Overview에만 존재) |
| 누락기능 | 거래처별 매출 변동 추이 (신규/이탈/성장/감소 거래처) |
| 누락기능 | 품목별 수익성 연계 (매출만 표시, 마진율 미표시) |
| 시각화 | Treemap에서 품목명 8자 절단 — 긴 품목명 식별 불가 |
| 시각화 | ABC 분석에서 A/B/C 등급 경계선 미표시 (80%, 95% 라인 없음) |

**보강 계획**:
- [ ] KPI 행 추가: 총 매출액, 거래처 수, 건당 평균, Top1 비중, 전기대비
- [ ] ABC 분석에 80%/95% ReferenceLine 추가, 등급별 색상 구분
- [ ] 월별 매출 추이 차트 추가 (Overview 중복 아닌 매출 전용 상세)
- [ ] 거래처 이동 분석 (신규/유지/이탈/복귀)
- [ ] 품목 Treemap에 마진율 색상 오버레이
- [ ] 내수/수출 분류 로직 보완 (거래통화 기반 대체 로직)

---

### 2.3 Orders (수주 분석)

**현재 상태**: 탭 2개 (현황/분석), KPI 4개, 차트 3개

**이슈 목록**:
| 구분 | 내용 |
|------|------|
| 계산오류 | 수주→매출 전환율이 100% 초과 시 설명 부재 (기수주 물량 매출 반영) |
| 계산오류 | 미출고 수주잔 = 수주 - 매출 단순 차감, 음수 가능 |
| 날짜처리 | extractMonth() 함수가 로컬에 중복 정의 (lib/로 이동해야) |
| 누락기능 | 조직별 수주 분석 없음 — 어느 조직이 수주 많은지 미표시 |
| 누락기능 | 거래처별 수주 분석 없음 — 핵심 거래처 수주 추이 미표시 |
| 누락기능 | 수주잔고 연령 분석 (수주일 기준 aging) |
| 누락기능 | 수주→매출 전환 파이프라인 시각화 (Funnel/Sankey) |
| 시각화 | 수주유형 PieChart에서 6개 초과 유형 절단 (.slice(0, 6)) |
| 시각화 | 리드타임 분포에서 평균/중앙값 참조선 없음 |

**보강 계획**:
- [ ] 조직별 수주 현황 BarChart 추가
- [ ] 거래처별 수주 Top N + 추이 차트
- [ ] 수주잔고 aging (30일/60일/90일/90일+)
- [ ] 수주→매출 전환 Funnel 차트
- [ ] 리드타임에 평균/중앙값 ReferenceLine 추가
- [ ] extractMonth() → lib/utils.ts로 이동, 공유
- [ ] 수주 파이프라인 예측 (미출고 잔고 기반)

---

### 2.4 Profitability (수익성 분석)

**현재 상태**: 탭 5개 (손익/조직/기여도/비용구조/계획달성), KPI 4개, 차트 8개+

**이슈 목록**:
| 구분 | 내용 |
|------|------|
| 치명적 | Waterfall 차트가 실제 Waterfall이 아닌 일반 BarChart. 누적/연결선/음수하향 없음 |
| 치명적 | Radar 차트에서 Math.abs() 사용 → 적자 조직이 흑자처럼 표시 |
| 계산오류 | ScatterChart Y축 domain 미설정 → 음수 영업이익율 영역 잘림 가능 |
| 구조결함 | 비용 효율성 테이블 10컬럼 → 모바일/태블릿 사용 불가 |
| 구조결함 | "조직평균" 컬럼이 어떤 비율의 평균인지 시각적 그룹핑 부재 |
| 누락기능 | 손익 분산분석 (계획 vs 실적의 유리/불리 요인 분해) |
| 누락기능 | 제품별/거래처별 수익성 (ProfitabilityAnalysisRecord 데이터 미활용) |
| 누락기능 | 비용 추이 (시계열) — 현재는 단기간 스냅샷만 |
| 누락기능 | 손익분기점 분석 (공헌이익 vs 고정비) |
| 누락기능 | 영업 레버리지 분석 |
| 히트맵 | rate > 999% 시 "N/A" 표시 — 사유 설명 없음 |
| 히트맵 | amber-400 + gray-900 텍스트 조합 WCAG 대비비 미달 가능 |

**보강 계획**:
- [ ] **Waterfall 차트 올바르게 재구현** (Recharts 커스텀 또는 전용 라이브러리)
- [ ] Radar 차트 Math.abs() 제거 → 음수 값 별도 표시 또는 차트 타입 변경
- [ ] ScatterChart에 domain 설정 (`[dataMin-5, dataMax+5]`)
- [ ] ProfitabilityAnalysisRecord 활용 → 제품×거래처 수익성 매트릭스
- [ ] 손익분기점 분석 탭 추가
- [ ] 비용 효율성 테이블 → 반응형 카드 또는 접기/펼치기 구조
- [ ] 히트맵 999% → "999%+" 표시 + 툴팁 사유 설명

---

### 2.5 Receivables (미수금 관리)

**현재 상태**: 탭 3개 (미수금현황/리스크/여신), KPI 8개, 차트 4개, 테이블 2개

**이슈 목록**:
| 구분 | 내용 |
|------|------|
| 계산오류 | 연체 기준 모호 — "4개월 이상" 표기이나 비즈니스 정의 불명확 (90일 vs 120일) |
| 계산오류 | creditDangerCount가 `상태 === "danger"` 문자열 비교 — 계산 함수 변경 시 불일치 |
| 데이터 | receivableAging Map 키 구조 미문서화 |
| 데이터 | `any[]` 타입 사용 (line 29, 41) — 타입 안전성 부재 |
| 시각화 | 연령별 StackedBar 색상이 안전→위험 그라데이션이 아닌 랜덤 배정 |
| 시각화 | 담당자별 차트 YAxis width=55 → 이름 잘림 |
| 누락기능 | DSO (Days Sales Outstanding) 미산출 |
| 누락기능 | 미수금 연령 추이 (시계열) — 월별 개선/악화 추이 |
| 누락기능 | 회수율/회수 효율성 지표 |
| 누락기능 | 분쟁/조정 금액 추적 |
| 누락기능 | 대손상각 이력/예측 |
| 누락기능 | 고객 지급행태 패턴 분석 (조기/정상/지연) |
| 누락기능 | 리스크 테이블 정렬/검색/페이지네이션 없음 |
| 누락기능 | 여신 사용률 테이블 내보내기 없음 |

**보강 계획**:
- [ ] DSO KPI 추가 (매출채권 × 365 / 매출액)
- [ ] 연령별 색상을 녹→노→주→적 그라데이션으로 변경
- [ ] 미수금 추이 라인차트 추가 (월별 총 미수금 변화)
- [ ] 회수 효율성 = 수금액 / (기초 미수금 + 당기 매출) × 100
- [ ] 고객 지급행태 패턴 분류 (Prompt/Normal/Slow/Delinquent)
- [ ] 리스크 테이블에 정렬, 검색, "전체보기" 기능
- [ ] `any[]` → `ReceivableAgingRecord[]` 타입 수정
- [ ] creditDangerCount를 `사용률 >= 100` 직접 비교로 변경

---

### 2.6 Profiles (영업사원 성과)

**현재 상태**: 탭 2개 (성과분석/순위), 프로필 카드, 레이더, 랭킹, HHI

**이슈 목록**:
| 구분 | 내용 |
|------|------|
| 계산오류 | 미수채권 데이터 유무에 따라 점수 체계 변경 (4축 25점 vs 5축 20점) — 사용자 혼란 |
| 계산오류 | 미수채권 데이터 없는 사원 → 건전성 만점(20점) 자동 부여 — 무데이터=완벽 |
| 로직오류 | `profiles[0]` 기본 선택 — 정렬 변경 시 다른 사원 자동 선택 |
| 시각화 | Radar fillOpacity 불일치 (개인 0.3 vs 평균 0.1) — 평균이 보이지 않을 수 있음 |
| 시각화 | 순위 차트 YAxis width=55 → 이름 잘림 |
| 시각화 | 7컬럼 그리드(lg) — 카드 너비 85px, 내용 표시 불가 |
| 누락기능 | 성과 추이 (시계열) — 현재 스냅샷만, 개선/하락 추세 불명 |
| 누락기능 | 동료 벤치마킹 (유사 조건 사원 비교) |
| 누락기능 | 목표 대비 달성률 (Quota attainment) |
| 누락기능 | 제품 포트폴리오 분석 (어떤 제품군 강점인지) |
| 누락기능 | 영역/지역별 성과 분석 |
| UX | 드롭다운에 검색 없음 — 200명+ 시 사용 불가 |

**보강 계획**:
- [ ] 점수 체계를 항상 5축 100점으로 통일 (미수채권 없으면 4축 균등 배분)
- [ ] 무데이터 = 만점이 아닌 "N/A" 또는 중립(50%) 처리
- [ ] 기본 선택을 `profiles[0]?.id`로 안정화
- [ ] 그리드를 `lg:grid-cols-4 xl:grid-cols-6`으로 변경
- [ ] 사원 드롭다운에 검색/자동완성 추가
- [ ] 목표 달성률 게이지 추가
- [ ] 제품 포트폴리오 PieChart 추가

---

### 2.7 Data (데이터 관리)

**현재 상태**: FileUploader만 표시

**이슈 목록**:
| 구분 | 내용 |
|------|------|
| 누락기능 | 파일 형식 가이드 / 예시 파일 다운로드 없음 |
| 누락기능 | 업로드 이력 로그 없음 |
| 누락기능 | 데이터 품질 대시보드 (완전성, 오류율, 누락 필드) |
| 누락기능 | 파일별 데이터 미리보기 / 검증 결과 |
| 누락기능 | 마지막 업데이트 시각 표시 |
| 누락기능 | 데이터 사전 (필드 정의, 형식 요구사항) |

**보강 계획**:
- [ ] 파일 형식별 가이드 카드 (9가지 타입, 필수 컬럼, 예시)
- [ ] 업로드 후 검증 결과 표시 (파싱된 행 수, 누락 필드, 타입 오류)
- [ ] 마지막 업데이트 시각 표시
- [ ] 데이터 품질 점수 (완전성 %, 정확성 %)

---

## 3. 데이터 레이어 이슈

### 3.1 미활용 데이터 분석

| 파일 타입 | 파싱 상태 | 활용 상태 | 활용 가능 분석 |
|-----------|----------|----------|--------------|
| ProfitabilityAnalysisRecord | ✅ 파싱됨 | ❌ 미사용 | 제품×거래처×담당자 수익성 매트릭스 |
| CustomerLedgerRecord | ✅ 파싱됨 | ❌ 미사용 | GL 원장 대사, 비용센터 분석, 프로젝트 수익성 |
| SalesRecord.환율/거래통화 | ✅ 파싱됨 | ❌ 미사용 | FX 영향 분석, 수출 마진 분석 |
| SalesRecord.결제조건/유통경로 | ✅ 파싱됨 | ❌ 미사용 | 결제조건별 매출, 채널별 수익성 |
| CollectionRecord.선수금액 | ✅ 파싱됨 | ❌ 미사용 | 선수금 관리, 현금흐름 예측 |
| AgingAmounts.출고금액/거래금액 | ✅ 파싱됨 | ❌ 미사용 | 출고 vs 장부 차이 분석 |
| Organization.시작일/종료일 | ✅ 파싱됨 | ❌ 미사용 | 조직 변동 이력, 유효 조직 필터 |
| TeamContribution (33개 중 23개) | ✅ 파싱됨 | ⚠️ 부분사용 | 상세 비용 드라이버 분석 |

### 3.2 추가 가능 분석 (엑셀 데이터 기반)

#### 즉시 구현 가능 (데이터 이미 존재)

| 분석 항목 | 필요 데이터 | 기대 효과 |
|-----------|------------|----------|
| **DSO** (매출채권 회전일) | 미수금합계 + 매출액 | 현금흐름 핵심 지표 |
| **수주→매출→수금 퍼널** | orderList + salesList + collectionList | O2C 프로세스 가시성 |
| **제품별 수익성** | ProfitabilityAnalysisRecord | 제품 포트폴리오 최적화 |
| **거래처 원장 대사** | CustomerLedgerRecord | 회계 정합성 검증 |
| **FX 영향 분석** | salesList.환율/거래통화 | 환율 리스크 정량화 |
| **결제조건별 분석** | salesList.결제조건 | 현금흐름 최적화 |
| **채널별 수익성** | salesList.유통경로 | 채널 전략 의사결정 |
| **거래처 RFM 분석** | salesList (최근성/빈도/금액) | 고객 세그멘테이션 |
| **비용 드라이버 분석** | TeamContribution 33개 항목 | 비용 절감 기회 발굴 |
| **프로젝트 수익성** | CustomerLedgerRecord.프로젝트명 | 프로젝트 관리 |

#### 크로스 데이터셋 분석 (복수 파일 연계)

| 분석 항목 | 연계 데이터 | 기대 효과 |
|-----------|------------|----------|
| **수익성×리스크 매트릭스** | orgProfit + receivableAging | 고수익/고위험 거래처 식별 |
| **담당자 종합 성과** | sales + orders + collections + aging + profitability | 360도 성과 평가 |
| **현금전환주기 (CCC)** | orders(수주일) → sales(매출일) → collections(수금일) | 운전자본 관리 |
| **조직 계층 분석** | organization + orgProfit | 사업부→조직→팀 롤업 |
| **예측 정확도** | orgProfit.계획 vs orgProfit.실적 시계열 | 계획 수립 역량 개선 |

### 3.3 파서(Parser) 버그

| # | 위치 | 이슈 | 영향 |
|---|------|------|------|
| P1 | `parser.ts:79` | SalesRecord row[15] 스킵 | 1개 필드 데이터 유실 |
| P2 | `parser.ts num()` | null/undefined → 0 무조건 변환 | 데이터 품질 이슈 은폐 |
| P3 | `schemas.ts` | 파일명 정규식이 서로 겹칠 수 있음 | 잘못된 파서 적용 가능 |
| P4 | `parser.ts` | merged header(0-1행) 처리가 일부 타입만 적용 | 헤더 불일치 가능 |

---

## 4. UI/컴포넌트 레이어 이슈

### 4.1 누락된 공통 컴포넌트

| 컴포넌트 | 필요성 | 현재 상태 |
|---------|--------|----------|
| **GlobalFilterBar** | 날짜범위, 조직선택, 기간비교 | 완전히 없음 |
| **DataTable** | 정렬, 검색, 페이지네이션, 내보내기 | 직접 `<table>` 반복 사용 |
| **ErrorBoundary** | 차트 렌더링 실패 격리 | 없음 → 전체 페이지 크래시 |
| **LoadingSkeleton** | 데이터 로딩 중 피드백 | 없음 → 빈 화면 |
| **ExportButton** | CSV/Excel/PDF 내보내기 | 없음 |
| **DrillDownModal** | KPI/차트 클릭 시 상세 보기 | 없음 |
| **MetricCard** | 전기대비 변동 시각화 (화살표/색상) | KpiCard에 부분 구현 |
| **DateRangePicker** | 기간 선택 UI | 없음 |
| **OrgSelector** | 다중 조직 선택 체크박스 | 없음 |

### 4.2 Header/Sidebar 이슈

| 이슈 | 상세 |
|------|------|
| 글로벌 필터 없음 | Header에 날짜/조직 필터 UI 없음 |
| 데이터 신선도 미표시 | 마지막 업로드 시각/데이터 기준일 없음 |
| 인쇄/내보내기 버튼 없음 | 리포트 출력 기능 없음 |
| 브레드크럼 없음 | 현재 위치 네비게이션 컨텍스트 미표시 |

### 4.3 접근성(A11y) 이슈

| 이슈 | 위치 |
|------|------|
| ARIA 라벨 미설정 | 차트, 테이블, 아이콘 버튼 |
| 키보드 네비게이션 미지원 | 탭 전환, 차트 인터랙션 |
| 색상만으로 정보 전달 | 히트맵, 리스크 배지 (색약 고려 안 됨) |
| 스크린리더 대응 없음 | 차트 대체 텍스트 없음 |

---

## 5. SAP 수준 대시보드 대비 갭 분석

### 5.1 SAP Analytics Cloud 핵심 기능 대비

| SAP 기능 | 현재 상태 | 갭 수준 |
|---------|----------|--------|
| **글로벌 필터 패널** | ❌ 없음 | 🔴 Critical |
| **기간 비교 (YoY/QoQ/MoM)** | ❌ 없음 | 🔴 Critical |
| **드릴다운/드릴스루** | ❌ 없음 | 🟠 High |
| **예외/경보 관리** | ❌ 없음 | 🟠 High |
| **계획 시뮬레이션 (What-if)** | ❌ 없음 | 🟡 Medium |
| **데이터 내보내기** | ❌ 없음 | 🟠 High |
| **인쇄/PDF 리포트** | ❌ 없음 | 🟡 Medium |
| **사용자 맞춤 대시보드** | ❌ 없음 | 🟡 Medium |
| **실시간 데이터 새로고침** | ❌ 없음 | 🔵 Low |
| **다국어 지원** | ❌ 없음 | 🔵 Low |
| **역할 기반 뷰** | ❌ 없음 | 🟡 Medium |
| **Waterfall 차트** | ⚠️ 잘못 구현됨 | 🔴 Critical |
| **Variance Analysis** | ❌ 없음 | 🟠 High |
| **KPI 드릴다운** | ❌ 없음 | 🟠 High |
| **데이터 품질 모니터링** | ❌ 없음 | 🟡 Medium |
| **조건부 서식** | ⚠️ 부분 구현 | 🔵 Low |

### 5.2 SAP FI/CO 표준 분석 대비

| SAP 분석 | 현재 구현 | 보강 필요 |
|---------|----------|----------|
| **손익계산서 (P&L)** | ⚠️ Waterfall 미흡 | 올바른 Waterfall + 드릴다운 |
| **매출채권 관리 (FI-AR)** | ✅ 기본 구현 | DSO, 회수 효율성, 지급행태 |
| **여신 관리 (FI-AR-CR)** | ✅ 기본 구현 | 여신 평점, 한도 조정 이력 |
| **원가 분석 (CO-PA)** | ⚠️ 부분 구현 | 제품/거래처/채널 수익성 |
| **계획 vs 실적 (CO-PA)** | ✅ 히트맵 구현 | 분산분석, 원인 분석 |
| **수주잔 관리 (SD)** | ⚠️ 기본만 | 수주잔 aging, 파이프라인 |
| **현금흐름 (TR-CM)** | ❌ 없음 | CCC, 현금 예측 |

---

## 6. Phase 5 구현 로드맵

### Phase 5-A: 치명적 버그 수정 (우선순위 최고)

1. Waterfall 차트 재구현
2. Radar 차트 Math.abs() 제거
3. 파서 row[15] 스킵 수정
4. share 비율 검증 로직 추가
5. ReferenceLine 위치 정합성 수정
6. 타입 안전성 강화 (`any` → 명시적 타입)

### Phase 5-B: SAP 수준 핵심 기능

1. **GlobalFilterBar 구현** — 날짜범위, 조직선택, 기간비교
2. **filterStore 연동** — 모든 페이지에서 통합 필터 사용
3. **DataTable 공통 컴포넌트** — 정렬, 검색, 페이지네이션
4. **ErrorBoundary 추가** — 차트별 에러 격리
5. **내보내기 기능** — CSV/Excel 다운로드

### Phase 5-C: 분석 고도화

1. **미활용 데이터 활성화**
   - ProfitabilityAnalysisRecord → 제품×거래처 수익성
   - CustomerLedgerRecord → 원장 대사, 프로젝트 분석
2. **크로스 데이터셋 분석**
   - 수주→매출→수금 퍼널
   - 수익성×리스크 매트릭스
   - DSO/현금전환주기
3. **KPI 보강**
   - 전기대비 증감율 (previousValue 연동)
   - 예측 정확도
   - 회수 효율성

### Phase 5-D: UX/시각화 개선

1. 페이지별 누락 KPI 카드 추가 (Sales, Orders)
2. 차트 색상 체계 통일 (특히 미수금 연령)
3. 모바일 반응형 레이아웃 수정
4. 로딩 스켈레톤 추가
5. 접근성 개선 (ARIA, 키보드, 색약 대응)

### Phase 5-E: 데이터 품질

1. 파서 에러 핸들링 강화 (num() 함수 검증 로직)
2. 업로드 시 데이터 검증 결과 표시
3. 데이터 품질 점수 대시보드
4. 필드 누락/타입 오류 경고

---

## 7. 파일별 수정 대상 요약

| 파일 | 수정 사항 수 | 우선순위 |
|------|------------|---------|
| `profitability/page.tsx` | 12건 | 🔴 최고 |
| `receivables/page.tsx` | 10건 | 🟠 높음 |
| `profiles/page.tsx` | 9건 | 🟠 높음 |
| `orders/page.tsx` | 8건 | 🟠 높음 |
| `sales/page.tsx` | 7건 | 🟡 중간 |
| `page.tsx (Overview)` | 6건 | 🟡 중간 |
| `lib/analysis/kpi.ts` | 5건 | 🟠 높음 |
| `lib/analysis/aging.ts` | 4건 | 🟠 높음 |
| `lib/analysis/profiling.ts` | 4건 | 🟡 중간 |
| `lib/excel/parser.ts` | 3건 | 🔴 최고 |
| `stores/dataStore.ts` | 3건 | 🟠 높음 |
| `stores/filterStore.ts` | 전면 연동 필요 | 🟠 높음 |
| `lib/utils.ts` | 2건 | 🟡 중간 |
| `components/ (신규)` | 5개 컴포넌트 | 🟠 높음 |

---

> **총 발견 이슈: 100건+** (Critical 6 / High 8 / Medium 9 / Low 5 / 기능누락 40+)
>
> Phase 5-A (버그수정) → Phase 5-B (핵심기능) → Phase 5-C (분석고도화) → Phase 5-D (UX) → Phase 5-E (데이터품질) 순서로 진행 권장
